

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>HTCondor Tools &mdash; pylhc 0.1.1 documentation</title>
  

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Sixdesk Tools" href="sixdesk_tools.html" />
    <link rel="prev" title="Data Extraction" href="data_extract.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html">
          

          
            
            <img src="../_static/omc_logo.svg" class="logo" alt="Logo"/>
          
          </a>

          
            
            
              <div class="version">
                0.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Entrypoints</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/analysis.html">Analysis Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/analysis.html#bsrt-analysis">BSRT Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/analysis.html#forced-da-analysis">Forced DA Analysis</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/bpm_calibration.html">BPM Calibration</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/bpm_calibration.html#id1">BPM Calibration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/machine_info.html">Machine Information Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/machine_info.html#print-machine-settings-overview">Print Machine Settings Overview</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../entrypoints/submitter.html">HTCondor Job Submitter</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/submitter.html#job-submitter">Job Submitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../entrypoints/submitter.html#autosix">AutoSix</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">Modules</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="calibration.html">BPM Calibration Utilities</a><ul>
<li class="toctree-l2"><a class="reference internal" href="calibration.html#beta">Beta</a></li>
<li class="toctree-l2"><a class="reference internal" href="calibration.html#dispersion">Dispersion</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="constants.html">Constants Definitions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="constants.html#constants-general">Constants: General</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html#constants-external-paths">Constants: External Paths</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html#constants-autosix">Constants: Autosix</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html#constants-forced-da-analysis">Constants: Forced DA Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html#constants-machine-settings-info">Constants: Machine Settings Info</a></li>
<li class="toctree-l2"><a class="reference internal" href="constants.html#constants-bpm-calibration">Constants: BPM Calibration</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="data_extract.html">Data Extraction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="data_extract.html#pylsa">PyLSA</a></li>
<li class="toctree-l2"><a class="reference internal" href="data_extract.html#timber">Timber</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">HTCondor Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#htcondor-utilities">HTCondor Utilities</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mask-resolver">Mask Resolver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="sixdesk_tools.html">Sixdesk Tools</a><ul>
<li class="toctree-l2"><a class="reference internal" href="sixdesk_tools.html#create-sixdesk-workspace">Create SixDesk Workspace</a></li>
<li class="toctree-l2"><a class="reference internal" href="sixdesk_tools.html#sixdesk-submission-utils">SixDesk Submission Utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="sixdesk_tools.html#post-process-da">Post Process DA</a></li>
<li class="toctree-l2"><a class="reference internal" href="sixdesk_tools.html#sixdesk-utilities">SixDesk Utilities</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">pylhc</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>HTCondor Tools</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/modules/htc.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-pylhc.htc.utils">
<span id="htcondor-tools"></span><h1>HTCondor Tools<a class="headerlink" href="#module-pylhc.htc.utils" title="Permalink to this headline">¶</a></h1>
<div class="section" id="htcondor-utilities">
<h2>HTCondor Utilities<a class="headerlink" href="#htcondor-utilities" title="Permalink to this headline">¶</a></h2>
<p>This module provides functionality to create HTCondor jobs and submit them to <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">write_bash</span></code> creates bash scripts executing either a python or madx script.
Takes as input <cite>Dataframe</cite>, job type, and optional additional commandline arguments for the script.
A shell script is created in each job directory in the dataframe.</p>
<p><code class="docutils literal notranslate"><span class="pre">make_subfile</span></code> takes the job dataframe and creates the <strong>.sub</strong> files required for submissions to
<code class="docutils literal notranslate"><span class="pre">HTCondor</span></code>. The <strong>.sub</strong> file will be put in the working directory. The maximum runtime of one
job can be specified, standard is 8h.</p>
<dl class="py function">
<dt id="pylhc.htc.utils.create_multijob_for_bashfiles">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.utils.</span></code><code class="sig-name descname"><span class="pre">create_multijob_for_bashfiles</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pylhc/htc/utils.html#create_multijob_for_bashfiles"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.utils.create_multijob_for_bashfiles" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to create an <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code> job assuming n_files bash-files.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>output_dir</strong> (<em>str</em>) -- output directory that will be transferred. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>duration</strong> (<em>str</em>) -- max duration of the job. Needs to be one of the <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code> Jobflavours.
Defaults to <code class="docutils literal notranslate"><span class="pre">workday</span></code>.</p></li>
<li><p><strong>group</strong> (<em>str</em>) -- force use of accounting group. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>retries</strong> (<em>int</em>) -- maximum amount of retries. Default to <code class="docutils literal notranslate"><span class="pre">3</span></code>.</p></li>
<li><p><strong>notification</strong> (<em>str</em>) -- Notify under certain conditions. Defaults to <code class="docutils literal notranslate"><span class="pre">error</span></code>.</p></li>
<li><p><strong>priority</strong> (<em>int</em>) -- Priority to order your jobs. Defaults to <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pylhc.htc.utils.create_subfile_from_job">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.utils.</span></code><code class="sig-name descname"><span class="pre">create_subfile_from_job</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cwd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pylhc/htc/utils.html#create_subfile_from_job"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.utils.create_subfile_from_job" title="Permalink to this definition">¶</a></dt>
<dd><p>Write file to submit to <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="pylhc.htc.utils.make_subfile">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.utils.</span></code><code class="sig-name descname"><span class="pre">make_subfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cwd</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">job_df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pylhc/htc/utils.html#make_subfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.utils.make_subfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates submit-file for <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code>.
For kwargs, see <code class="docutils literal notranslate"><span class="pre">create_multijob_for_bashfiles</span></code>.</p>
</dd></dl>

<dl class="py function">
<dt id="pylhc.htc.utils.submit_jobfile">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.utils.</span></code><code class="sig-name descname"><span class="pre">submit_jobfile</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">jobfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ssh</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pylhc/htc/utils.html#submit_jobfile"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.utils.submit_jobfile" title="Permalink to this definition">¶</a></dt>
<dd><p>Submit subfile to <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code> via subprocess.</p>
</dd></dl>

<dl class="py function">
<dt id="pylhc.htc.utils.write_bash">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.utils.</span></code><code class="sig-name descname"><span class="pre">write_bash</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_dir</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">pathlib.Path</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">executable</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'madx'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cmdline_arguments</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">pandas.core.frame.DataFrame</span><a class="reference internal" href="../_modules/pylhc/htc/utils.html#write_bash"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.utils.write_bash" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the bash-files to be called by <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code>.</p>
</dd></dl>

</div>
<span class="target" id="module-pylhc.htc.mask"></span><div class="section" id="mask-resolver">
<h2>Mask Resolver<a class="headerlink" href="#mask-resolver" title="Permalink to this headline">¶</a></h2>
<p>This module provides functionality to resolve and write script masks for <code class="docutils literal notranslate"><span class="pre">HTCondor</span></code> jobs
submission.</p>
<dl class="py function">
<dt id="pylhc.htc.mask.check_percentage_signs_in_mask">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.mask.</span></code><code class="sig-name descname"><span class="pre">check_percentage_signs_in_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pylhc/htc/mask.html#check_percentage_signs_in_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.mask.check_percentage_signs_in_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks for ‘%’ in the mask, that are not replacement variables.</p>
</dd></dl>

<dl class="py function">
<dt id="pylhc.htc.mask.create_jobs_from_mask">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.mask.</span></code><code class="sig-name descname"><span class="pre">create_jobs_from_mask</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">job_df</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pandas.core.frame.DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maskfile</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">pathlib.Path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_keys</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_ext</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">pandas.core.frame.DataFrame</span><a class="reference internal" href="../_modules/pylhc/htc/mask.html#create_jobs_from_mask"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.mask.create_jobs_from_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes path to mask file, list of parameter to be replaced and pandas dataframe containg per job
the job directory where processed mask is to be put, and columns containing the parameter values
with column named like replace parameters. Job directories have to be created beforehand.
Processed (madx) mask has the same filename as mask but with the given file extension.
Input Dataframe is returned with additional column containing path to the processed script
files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>job_df</strong> (<em>pd.DataFrame</em>) -- Job parameters as defined in description.</p></li>
<li><p><strong>maskfile</strong> -- <cite>Path</cite> object to the mask file.</p></li>
<li><p><strong>replace_keys</strong> -- keys to be replaced (must correspond to columns in <code class="docutils literal notranslate"><span class="pre">job_df</span></code>).</p></li>
<li><p><strong>file_ext</strong> -- file extention to use (defaults to <strong>madx</strong>).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The provided <code class="docutils literal notranslate"><span class="pre">job_df</span></code> but with added path to the scripts.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt id="pylhc.htc.mask.generate_jobdf_index">
<code class="sig-prename descclassname"><span class="pre">pylhc.htc.mask.</span></code><code class="sig-name descname"><span class="pre">generate_jobdf_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">old_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">jobid_mask</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keys</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">values</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pylhc/htc/mask.html#generate_jobdf_index"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#pylhc.htc.mask.generate_jobdf_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates index for jobdf from mask for job_id naming.</p>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="sixdesk_tools.html" class="btn btn-neutral float-right" title="Sixdesk Tools" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="data_extract.html" class="btn btn-neutral float-left" title="Data Extraction" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2019-2020, pyLHC/OMC-TEAM.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>