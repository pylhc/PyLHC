# <img src="https://twiki.cern.ch/twiki/pub/BEABP/Logos/OMC_logo.png" height="28"> PyLHC Tools

[![Travis (.com)](https://img.shields.io/travis/com/pylhc/PyLHC.svg?style=popout)](https://travis-ci.com/pylhc/PyLHC/)
[![Code Climate coverage](https://img.shields.io/codeclimate/coverage/pylhc/PyLHC.svg?style=popout)](https://codeclimate.com/github/pylhc/PyLHC)
[![Code Climate maintainability (percentage)](https://img.shields.io/codeclimate/maintainability-percentage/pylhc/PyLHC.svg?style=popout)](https://codeclimate.com/github/pylhc/PyLHC)
[![GitHub last commit](https://img.shields.io/github/last-commit/pylhc/PyLHC.svg?style=popout)](https://github.com/pylhc/PyLHC/)
[![GitHub release](https://img.shields.io/github/release/pylhc/PyLHC.svg?style=popout)](https://github.com/pylhc/PyLHC/)

This is the python-tool package of the optics measurements and corrections group (OMC).

If you are not part of that group, you will most likely have no use for the codes provided here,
unless you have a 9km wide accelerator at home.
Feel free to use them anyway, if you wish!

## Documentation

- Autogenerated docs via ``sphinx`` can be found on <https://pylhc.github.io/PyLHC/>.
- General documentation of the OMC-Teams software on <https://twiki.cern.ch/twiki/bin/view/BEABP/OMC>

## Getting Started

### Prerequisites and Installation
This package is not deployed, hence you need to use the standard git-commands (below) to get a local copy.

To install directly from git one can use
```
python -m pip install -e git+git://github.com/pylhc/pylhc.git#egg=pylhc
```
or install from a local copy (see [install in editable mode.](#install-in-editable-mode)).

The codes use a multitude of packages, which can be found in the [setup.py](setup.py) file.
Hence, `pip` will install the required dependencies automatically, if not present.

Important packages are: ``tfs-pandas``,  ``generic_parser``, ``numpy``, ``pandas`` and ``scipy``.

Note, that `omc3` and `pyjapc` might need to be installed manually from local clones or via

```
python -m pip install git+git://github.com/pylhc/omc3.git#egg=omc3
python -m pip install git+https://gitlab.cern.ch/scripting-tools/pyjapc.git#egg=pyjapc
```

## Description

This package provides tools which can be useful for working with accelerators, but are not neccessary for
optics measurements analysis.

The latter tools can be found in [OMC3](https://github.com/pylhc/omc3) (Python 3.7+) or [Beta-Beat.src](https://github.com/pylhc/Beta-Beat.src) (Python 2.7)

## Functionality

- *Forced DA Analysis* - Script to analyse forced DA. ([**forced_da_analysis.py**](https://github.com/pylhc/PyLHC/blob/master/pylhc/forced_da_analysis.py))
- *Machine Settings Info* - Prints an overview over the machine settings at a given time. ([**machine_settings_info.py**](https://github.com/pylhc/PyLHC/blob/master/pylhc/machine_settings_info.py))
- *HTCondor Job Submitter* - Allows to generate jobs based on a templates and submit them to HTCondor. ([**job_submitter.py**](https://github.com/pylhc/PyLHC/blob/master/pylhc/job_submitter.py))
- *BSRT Logger* and *BSRT Analysis* - Saves data coming straight from LHC BSRT FESA class and allows subsequent analysis. ([**BSRT_logger.py**](https://github.com/pylhc/PyLHC/blob/master/pylhc/BSRT_logger.py) & [**BSRT_analysis.py**](https://github.com/pylhc/PyLHC/blob/master/pylhc/BSRT_analysis.py) )

### Tests

- Pytest unit tests are run automatically after each commit via 
[Travis-CI](https://travis-ci.com/pylhc/PyLHC). 

### Maintainability

- Additional checks for code-complexity, design-rules, test-coverage, duplication on 
[CodeClimate](https://codeclimate.com/github/pylhc/PyLHC)

- Direct commits to master are forbidden.

## Hints for Developers

### Install in Editable Mode

In case you want to install `pylhc` as a development package
from the current folder, you can use:

```
git clone https://github.com/pylhc/pylhc
python -m pip install --editable pylhc
```

This installs the package as a link into the python environment and any changes 
are reflected immediately, without the need to reinstall.

#### Dependencies 

```
python -m pip install -e pylhc
```

will also hence install the required dependencies. 

If you want to install more dependencies, you can use for example:

```
python -m pip install -e pylhc[test]
python -m pip install -e pylhc[setup]
python -m pip install -e pylhc[test,doc]
python -m pip install -e pylhc[all]
```
where the last one installs **all** dependencies defined in `setup.py`.
 
Note that the default dependencies and pylhc-as-link are also always installed.
 
## Authors

* **pyLHC/OMC-Team** - *Working Group* - [pyLHC](https://github.com/orgs/pylhc/teams/omc-team)

## License
This project is licensed under the MIT License - see the [LICENSE](LICENSE.md) file for details.
